\lstdefinelanguage{JavaScript}{
  keywords={break, case, catch, class, const, constructor, continue, debugger, default, delete, do, else, finally, for, function, if, in, instanceof, let, new, return, super, switch, this, throw, try, typeof, var, void, while, with},
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  sensitive=true
}


\begin{frame}{Lernziele}
    \begin{itemize}
        \item Kennenlernen von Python und  Einsatzmöglichkeiten
        \item Programmiercode strukturieren und Module verwenden
        \item Messwerte auf dem Raspberry Pi auslesen
        \item Grundlegender Umgang mit Visual Studio Code
        \item Umgang mit Problemstellungen beim Programmieren für IoT Devices
        \item Wichtige Programmierbausteine kennenlernen
    \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------
\section{Einführung Python}


%-------------------------------------------------------------------------------

\begin{frame}{Warum Python?}
    \begin{figure}[!htb]
        \includegraphics[scale=0.25]{4-programmierung/img/240px-Python-logo-notext}
    \end{figure}
    \begin{itemize}
        \item Plattformunabhängig  $\rightarrow$ interpretierte Sprache
        \item Arm an Boiler-Plate Code
        \item Knapp gehaltene Syntax
        \item Open Source
        \item Unterstützt verschiedene Paradigmen
        \item Viele Software-Bibliotheken vorhanden
    \end{itemize}
\end{frame}


\begin{frame}{Wo wird Python eingesetzt?}

    \begin{itemize}
    \setlength{\itemindent}{3.0in}
     \item [\textbf{ Laut Python Package Index (siehe \url{https://pypi.org})}]
    \end{itemize}
    \begin{itemize}
        \item Rapid Prototyping
        \item Administratives Scripting
        \item Wissenschaftliche Software/Data Science
        \item Machine Learning und Big Data
        \item ...
     \end{itemize}
\end{frame}


\begin{frame}{Python und Raspberry Pi}
    \begin{itemize}
    \setlength{\itemindent}{.3in}
     \item [\textbf{ Fakten}]
    \end{itemize}
    \begin{itemize}
        \item Historisch steht Pi  für Python Interpreter
        \item Ursprünglich sollte in Python programmiert werden
        \item Python Interpreter ist üblicherweise vorinstalliert in Raspbian
     \end{itemize}
\end{frame}

\begin{frame}{Python 2 vs. Python 3}
 
    \begin{itemize}
    \setlength{\itemindent}{1.0in}
     \item [\textbf{ Warum wichtig ?}]
    \end{itemize}
    \begin{itemize}
        \item Viele Beispiele und Libraries verwenden noch Version 2
        \item Version 2 wird ab 2020 nicht mehr offiziell von den Entwicklern unterstützt
        \item Die größeren bekannten und wichtigsten Projekte setzen auf Python 3  
        \item Siehe \url{https://python3statement.org}
        \item Zum Aufrufen des Interpreters sollte man daher python3 nutzen
        \item Vergleich und Tipps: \url{https://devopedia.org/python-2-vs-3}
     \end{itemize}
\end{frame}


\begin{frame}[fragile]{Python vs. Java vs. JavaScript - Hello World}
\begin{lstlisting}[language=Python]
	# Hello World in Python
 	print('Hello World!') 
\end{lstlisting}
\begin{lstlisting}[language=JavaScript]
       // Hello World in Java Script (Backend Version)
       console.log('Hello World!') 
\end{lstlisting}
\begin{lstlisting}[language=Java]
       /** Hello World in Java */
       public class HelloWorld {
      	    public static void main(String[] args){
                System.out.println("Hello World");
      	 }
       }
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Python vs. Java vs. JavaScript - Funktionen}
\begin{lstlisting}[language=Python]
	# Funktion in Python
 	def my_function(parameter):  # keine Typeninformation
	  a = 1
	  return parameter * parameter + a
	\end{lstlisting}
\begin{lstlisting}[language=JavaScript]
       // Funktion in Java Script
 	  function myFunction(parameter){ // keine Typeninformation
	       let a = 1;
	       return parameter * parameter + a;
	  }
\end{lstlisting}
\begin{lstlisting}[language=Java]
       /** Methode in Java */
      	 public int myFunction (int parameter){  // Typeninformation
	           int a = 1;
	           return parameter * parameter + a;
         }
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Python vs. Java vs. JavaScript - Klassen}
\begin{lstlisting}[language=Python]
	# Klasse in Python
 	class MyClass(Superklasse): 
	   __init__(self, value):
	       super().__init__(value, value)
	       self.value = value;
	       
	     def my_method():
	        return self.value
	  
	\end{lstlisting}
\begin{lstlisting}[language=JavaScript]
       // Klasse in Java Script
 	  class MyClass extends Superklasse{
	        constructor() {
	           super(value);
	           this.value = value; 
	        }
	       myMethod(){ return this.value;
	       }
	    }
\end{lstlisting}
\begin{lstlisting}[language=Java]
       /** Klasse in Java */
         public class MyClass extends Superklasse{
 
              private int value;
              
              MyClass(int value){
              	 super(value);
                  this.value = value;
              }
      	     public int myMethod (){  return this.value;
	     }
         }
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Python Duck Typing 1}
Beispiel basierend auf \url{https://hackernoon.com/python-duck-typing-or-automatic-interfaces-73988ec9037f}
\begin{lstlisting}[language=Python]
 """ Intention: ein Vogel gibt Laut, Ergebnis: Ein Betrüger geht als Vogel durch, denn er kann ja quack machen und nimmt das Geld mit.
 """
class Ente:
	  def quack(self):
             print('Quack!')
             
class Gans:
	  def quack(self):
             print('Quaaaack')
             

class Quacksalber:
      def quack(self):
             print('Quack')
             print('Ich nehme dann mal dein Geld!')


list = [Ente(), Gans(), Quacksalber()]
        
for item in list:
 item.quack()  

	\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Python Duck Typing 2}
\begin{lstlisting}[language=Python]
 """ Intention: Verschiedene Sensoren sollen über gemeinsame Schnittstelle die Distanz zurückliefern
 """
class UltraschallSensor:
	  def get_distance(self):
	     # ... über Bibliothek Auslesen, bspw. 200 cm
	     return input() # zum Test: User Eingabe über Keyboard
             
class InfrarotSensor:
	  def get_distance(self):
	   return  input()

def print_distance(sensor):
  print(sensor.get_distance())

print_distance(UltraschallSensor())

\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Python Datenstrukuren 1}
\begin{lstlisting}[language=Python]
 """ Intention:  Liste mit vordefinierten und erweiterbaren Schluesseln, Format aehnlich zu Java Script Object Literals
  """
 # Meet the Dictionary
 eingabe_schuessel = 15 # ist z.B. ein Sensorwert
 
 switcher = {
        15:   'Nah',     # Schluessel : Wert
        30:   'Naeher',
        70:   'Weit weg'
 }
 switcher[99] = 'Gerade noch messbar'
 
 ergebnis = switcher.get(eingabe_schuessel, 'UNGUELTIG')
 
  #das geht auch mit Funktionen als Werte https://jaxenter.com/implement-switch-case-statement-python-138315.html
 
 # Analog in if-else:
 if(eingabe_schuessel == 15):
    # tue etwas
 elif(eingabe_schuessel == 30):
   # tue etwas anderes
 else:
   # z.B. ungueltig ausgeben
 

\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Python Datenstrukuren 2}
\begin{lstlisting}[language=Python]
 """ Intention:  Liste mit Zahlen fuer Diodenhelligkeit
  """
 # Meet the List
intensities = [0, 0.5, 1]

print(intensities[2])

for value in intensities:
   print(value)
   
intensities.append(1.5)
intensities.remove(0)
intensities.pop(0)

   
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Python Datenstrukuren 3}
\begin{lstlisting}[language=Python]
 """ Intention:  Zusammengehoerige Werte im Code zusammenhalten
  """
 # Meet the Tuple
sensor_messung = (0.3, '2019-10-07-15:00:01.996')

print('Der Messwert um', sensor_messung[1], ' war: ', sensor_messung[0])

\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Sauberes Programmieren: Coding Conventions}
    \begin{itemize}
    \setlength{\itemindent}{.5in}
     \item [\textbf{ Richtlinien}]
    \end{itemize}
    \begin{itemize}
        \item Python Enhancement Proposals enthalten u.a. Guidelines für lesbaren Code
        \item Siehe: \url{https://pep8.org/#naming-conventions}
        \item Autopep hilfreich für die Entwicklungsumgebung, siehe:  \url{https://pypi.org/project/autopep8/}
     \end{itemize}
\end{frame}



\begin{frame}[fragile]{Sauberes Programmieren: Zen of Python}
\url{https://www.python.org/dev/peps/pep-0020/#the-zen-of-python}
\begin{lstlisting}[language=Python]
""" Zen: japanische Richtung des Buddhismus, die durch Meditation die Erfahrung der Einheit allen Seins und damit tätige Lebenskraft und größte Selbstbeherrschung zu erreichen sucht. """

# Python Easter Egg:
import this
\end{lstlisting}
\begin{lstlisting}	
Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren't special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you're Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it's a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let's do more of those!
\end{lstlisting}
\end{frame}


\begin{frame}{Beispiel: Sensoren auslesen mit GPIO}
    \begin{itemize}
    \setlength{\itemindent}{.4in}
     \item [\textbf{ Ziele}]
    \end{itemize}
    \begin{itemize}
        \item  LED mittels PWM ansteuern
        \item  Abstandsmessung einbinden
        \item  Abstandsmessung und LED verbinden
        \item  Code modular aufbauen
        \item  Module zusammensetzen 
     \end{itemize}
\end{frame}


\begin{frame}{Beispiel: Sensoren auslesen mit GPIO}
    \begin{itemize}
    \setlength{\itemindent}{1.0in}
     \item [\textbf{ Dokumentation}]
    \end{itemize}

    \begin{itemize}
        \item  Datenblatt der Sensoren: \url{https://produktinfo.conrad.com/datenblaetter/1400000-1499999/001413759-an-01-de-SENSORKIT_X40_FUER_EINPLATINEN_COMPUTER.pdf}
        \item  API zu GPIOZero: \url{https://gpiozero.readthedocs.io/en/stable/} 
     \end{itemize}
\end{frame}


\begin{frame}[fragile]{Python Sourcecode Struktur: Hauptprogramm}
\begin{lstlisting}[language=Python]
""" Basiert auf:  https://gpiozero.readthedocs.io/en/stable/recipes.html """
import sys # Systemfunktionen
import logging # Ausgabe von Nachrichten
from gpiozero import PWMLED #Bibliothek fuer LED Pulsweitenmodulation
from time import sleep # Pausefunktion aus der Standardbibliothek
logger = logging.getLogger(__name__) # Managing der Ausgabe anstatt print() Funktion

led = PWMLED(17) #  LED Kontrolle für GPIO PIN 17 an Variable zuweisen

def led_dim(value):
    led.value = value # LED auf Wert setzen
    sleep(1) # 1 ms warten

try:
       while True:  # Programm am Laufen halten
             led_dim(0)  # LED aus
             led_dim(0.5) # LED 50 % Helligkeit
             led_dim(1) # LED 100 % Helligkeit
except KeyboardInterrupt:  
       logger.info('Ende wegen User Eingabe')
except:  
       logger.error('Ende wegen Programmfehler: %s', sys.exc_info()[0])
finally:  
       led.close() # PIN Konfiguration zurücksetzen

\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Python Sourcecode Struktur: Modul 1}
\begin{lstlisting}[language=Python]

import sys # Systemfunktionen
import logging # Ausgabe von Nachrichten
from gpiozero import PWMLED #Bibliothek fuer LED Pulsweitenmodulation
from time import sleep # Pausefunktion aus der Standardbibliothek

class LedBlinker:
	 
   __led = PWMLED(17) #  LED Kontrolle für GPIO PIN 17 an private Variable zuweisen
   
   __logger = logging.getLogger(__name__) # Managing der Ausgabe anstatt print() Funktion
   
   def led_dim(value):
      self.__led.value = value # LED auf Wert setzen
      sleep(1) # 1 ms warten
   
   def blink_led(self):
      try:
        for duration in [0, 0.5,1, 0.5]:  # aus, 50%, 100%, 50%
          self.led_dim(duration)  # LED     
      except KeyboardInterrupt:  
          __logger.info('Ende wegen User Eingabe')
      except:  
         __logger.error('Ende wegen Programmfehler: %s', sys.exc_info()[0]) # siehe https://docs.python.org/3/tutorial/errors.html
      finally:  
         self.__led.close() # PIN Konfiguration zurücksetzen

\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Python Sourcecode Struktur: Modul 1 einbinden}
\begin{lstlisting}[language=Python]
import logging # Ausgabe von Nachrichten
logger = logging.getLogger(__name__) # Managing der Ausgabe anstatt print() Funktion

from led_util import LedBlinker

if __name__ == '__main__':
    blinker = LedBlinker()
    while True:  # Programm am Laufen halten
       try:
         blinker.blink_led()  # LED 
       except KeyboardInterrupt:  
         logger.info('Ende wegen User Eingabe')

\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Python Sourcecode Struktur: Modul 2}
\begin{lstlisting}[language=Python]

import sys # Systemfunktionen
import logging # Ausgabe von Nachrichten
from gpiozero import DistanceSensor #Bibliothek fuer Ultraschallsensor

class Ultraschallsensor:
	 
   __sensor = DistanceSensor(echo=18, trigger=17, threshold_distance = 0.1, max_distance=1) #  Sensor Kontrolle für GPIO PIN  Input 17 und Output 18 an private Variable zuweisen
   
   __logger = logging.getLogger(__name__) # Managing der Ausgabe anstatt print() Funktion
   
   def __init__(self):  # __sensor.when_out_of_range = handle_out_of_range # Funktion, die z.B. loggt
        pass
   
   def read_distance_ic_cm(self):
         distance = -1
      try:
          distance = self.__sensor.distance * 100
      except KeyboardInterrupt:  
          self.__logger.info('Ende wegen User Eingabe')
      except:  
         self.__logger.error('Ende wegen Programmfehler: %s', sys.exc_info()[0]) # siehe https://docs.python.org/3/tutorial/errors.html
      finally:  
         self.__sensor .close() # PIN Konfiguration zurücksetzen
         
      return distance

\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Python Sourcecode Struktur: Modul 1  und 2 einbinden}
\begin{lstlisting}[language=Python]
import logging # Ausgabe von Nachrichten
logger = logging.getLogger(__name__) # Managing der Ausgabe anstatt print() Funktion

from led_util import LedBlinker
from distance_util import Ultraschallsensor

if __name__ == '__main__':
    blinker = LedBlinker()
    ultraschall_sensor =  Ultraschallsensor()
    while True:  # Programm am Laufen halten
       try:
         distance_in_cm = ultraschall_sensor.read_distance_in_cm()
         if(distance >= 15):
            blinker.blink_led(duration)  # LED
         else:
            logger.info('Nichts ungewoehnliches entdeckt') 
       except KeyboardInterrupt:  
         logger.info('Ende wegen User Eingabe')

\end{lstlisting}
\end{frame}




